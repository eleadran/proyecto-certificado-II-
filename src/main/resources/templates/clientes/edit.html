<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:insert="~{layout::head}">
    <meta charset="UTF-8">
    <title>Actualizar clientes</title>
</head>
<body>
<nav th:insert="~{layout::menu}"></nav>
<br />
<div class="card">
    <div class="card-header text-bg-secondary">
        Mantenimiento de clientes
    </div>
    <div class="card-body">
        <h5 class="card-title">Actualizar clientes</h5>
        <hr />
        <form th:action="@{/clientes/save}" method="post" th:object="${cliente}" onsubmit="return validarFormulario()">

            <!-- Mostrar el ID en solo lectura -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtId"
                       th:field="*{cod_cliente}" placeholder="ID del cliente" disabled>
                <label for="txtId">ID del cliente</label>
            </div>
            <input type="hidden" th:field="*{cod_cliente}">

            <!-- Nombre -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtnombre_cliente" th:field="*{nombre_cliente}"
                       placeholder="Nombre" required>
                <label for="txtnombre_cliente">Nombre de cliente</label>
                <div class="text-danger small" id="errorNombre"></div>
            </div>

            <!-- Apellido -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtapellido_cliente" th:field="*{apellido_cliente}"
                       placeholder="Apellido" required>
                <label for="txtapellido_cliente">Apellido del cliente</label>
                <div class="text-danger small" id="errorApellido"></div>
            </div>

            <!-- Trabajo -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txttrabajo_cliente" th:field="*{trabajo_cliente}"
                       placeholder="Trabajo" required>
                <label for="txttrabajo_cliente">Trabajo del cliente</label>
                <div class="text-danger small" id="errorTrabajo"></div>
            </div>

            <!-- Teléfono -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txttelefono_cliente" th:field="*{telefono_cliente}"
                       placeholder="Teléfono" required maxlength="9" minlength="9">
                <label for="txttelefono_cliente">Teléfono del cliente</label>
                <div class="text-danger small" id="errorTelefono"></div>
            </div>

            <!-- Dirección -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtdireccion_cliente" th:field="*{direccion_cliente}"
                       placeholder="Dirección" required>
                <label for="txtdireccion_cliente">Dirección del cliente</label>
            </div>

            <button type="submit" class="btn btn-primary">Actualizar cliente</button>
            <a th:href="@{/clientes}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>
</div>

<script>
    // Función para validar solo letras y espacios (sin números ni caracteres especiales)
    function validarTexto(campoId, errorId, campoNombre) {
        document.getElementById(campoId).addEventListener("input", function () {
            let valor = this.value.trim();
            let error = document.getElementById(errorId);

            if (/\d/.test(valor)) {
                error.textContent = `⚠️ El ${campoNombre} no puede contener números.`;
            }
            else if (/[^a-zA-ZáéíóúÁÉÍÓÚñÑ\s]/.test(valor)) {
                error.textContent = `⚠️ El ${campoNombre} no puede contener caracteres especiales.`;
            }
            else {
                error.textContent = "";
            }
        });
    }

    // Validación en tiempo real para nombre, apellido y trabajo
    validarTexto("txtnombre_cliente", "errorNombre", "nombre");
    validarTexto("txtapellido_cliente", "errorApellido", "apellido");
    validarTexto("txttrabajo_cliente", "errorTrabajo", "trabajo");

    // Validación en tiempo real para TELÉFONO
    document.getElementById("txttelefono_cliente").addEventListener("input", function () {
        let valor = this.value.trim();
        let error = document.getElementById("errorTelefono");

        if (/[a-zA-Z]/.test(valor)) {
            error.textContent = "⚠️ El teléfono no puede contener letras.";
        }
        else if (/[^0-9]/.test(valor)) {
            error.textContent = "⚠️ El teléfono no puede contener caracteres especiales.";
        }
        else if (valor.length > 0 && valor.length !== 9) {
            error.textContent = "⚠️ El teléfono debe tener exactamente 9 dígitos numéricos.";
        }
        else {
            error.textContent = "";
        }
    });

    // Validación final al enviar
    function validarFormulario() {
        let nombre = document.getElementById("txtnombre_cliente").value.trim();
        let apellido = document.getElementById("txtapellido_cliente").value.trim();
        let trabajo = document.getElementById("txttrabajo_cliente").value.trim();
        let telefono = document.getElementById("txttelefono_cliente").value.trim();

        let errorNombre = document.getElementById("errorNombre");
        let errorApellido = document.getElementById("errorApellido");
        let errorTrabajo = document.getElementById("errorTrabajo");
        let errorTelefono = document.getElementById("errorTelefono");

        let valido = true;

        errorNombre.textContent = "";
        errorApellido.textContent = "";
        errorTrabajo.textContent = "";
        errorTelefono.textContent = "";

        // Validar nombre
        if (/\d/.test(nombre)) {
            errorNombre.textContent = "⚠️ El nombre no puede contener números.";
            valido = false;
        }
        else if (/[^a-zA-ZáéíóúÁÉÍÓÚñÑ\s]/.test(nombre)) {
            errorNombre.textContent = "⚠️ El nombre no puede contener caracteres especiales.";
            valido = false;
        }

        // Validar apellido
        if (/\d/.test(apellido)) {
            errorApellido.textContent = "⚠️ El apellido no puede contener números.";
            valido = false;
        }
        else if (/[^a-zA-ZáéíóúÁÉÍÓÚñÑ\s]/.test(apellido)) {
            errorApellido.textContent = "⚠️ El apellido no puede contener caracteres especiales.";
            valido = false;
        }

        // Validar trabajo
        if (/\d/.test(trabajo)) {
            errorTrabajo.textContent = "⚠️ El trabajo no puede contener números.";
            valido = false;
        }
        else if (/[^a-zA-ZáéíóúÁÉÍÓÚñÑ\s]/.test(trabajo)) {
            errorTrabajo.textContent = "⚠️ El trabajo no puede contener caracteres especiales.";
            valido = false;
        }

        // Validar teléfono
        if (/[a-zA-Z]/.test(telefono)) {
            errorTelefono.textContent = "⚠️ El teléfono no puede contener letras.";
            valido = false;
        }
        else if (/[^0-9]/.test(telefono)) {
            errorTelefono.textContent = "⚠️ El teléfono no puede contener caracteres especiales.";
            valido = false;
        }
        else if (!/^\d{9}$/.test(telefono)) {
            errorTelefono.textContent = "⚠️ El teléfono debe tener exactamente 9 dígitos numéricos.";
            valido = false;
        }

        return valido;
    }
</script>

</body>
</html>


