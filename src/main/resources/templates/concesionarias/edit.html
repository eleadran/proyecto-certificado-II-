<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{layout::head}">
    <meta charset="UTF-8">
    <title>Editar Concesionaria</title>
    <style>
        .text-danger {
            font-size: 0.9em;
        }
    </style>
</head>
<body>
<nav th:insert="~{layout::menu}"></nav>
<br />
<div class="card">
    <div class="card-header text-bg-secondary">
        Mantenimiento de Concesionarias
    </div>
    <div class="card-body">
        <h5 class="card-title">Editar Concesionaria</h5>
        <hr />
        <form th:action="@{/concesionarias/save}" method="post" th:object="${concesionaria}" onsubmit="return validarFormulario()">

            <!-- ID Concesionaria (solo lectura) -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtCodConcesionaria"
                       th:field="*{codConcesionaria}" readonly>
                <label for="txtCodConcesionaria">ID Concesionaria</label>
            </div>

            <!-- Nombre Concesionaria -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtnombre_concesionaria" th:field="*{nombreConcesionaria}"
                       placeholder="Ejemplo: Concesionaria Central" required>
                <label for="txtnombre_concesionaria">Nombre de la Concesionaria</label>
                <div class="text-danger small" id="errorNombreConcesionaria"></div>
            </div>

            <!-- Cantidad Trabajadores -->
            <div class="form-floating mb-3">
                <input type="number" class="form-control" id="txtcantidad_trabaja_concesionaria" th:field="*{cantidadTrabajaConcesionaria}"
                       placeholder="Ejemplo: 50" required>
                <label for="txtcantidad_trabaja_concesionaria">Cantidad de Trabajadores</label>
                <div class="text-danger small" id="errorCantidadTrabajadores"></div>
            </div>

            <!-- Dirección -->
            <div class="form-floating mb-3">
                <input type="text" class="form-control" id="txtdireccion_concesionaria" th:field="*{direccionConcesionaria}"
                       placeholder="Ejemplo: Calle Principal 123" required>
                <label for="txtdireccion_concesionaria">Dirección de la Concesionaria</label>
            </div>

            <!-- Proveedor -->
            <div class="form-floating mb-3">
                <select class="form-select" id="txtcod_proveedor" th:field="*{proveedores.codProveedor}" required>
                    <option th:each="proveedor : ${proveedores}"
                            th:value="${proveedor.codProveedor}"
                            th:text="${proveedor.nombreProveedor}">
                    </option>
                </select>
                <label for="txtcod_proveedor">Proveedor</label>
            </div>

            <!-- Botón para Actualizar -->
            <button type="submit" class="btn btn-primary">Actualizar cliente</button>
            <a th:href="@{/concesionarias}" class="btn btn-secondary">Cancelar</a>
        </form>
    </div>
</div>

<!-- Script Validación -->
<script>
    function validarFormulario() {
        const nombre = document.getElementById("txtnombre_concesionaria").value.trim();
        const cantidad = document.getElementById("txtcantidad_trabaja_concesionaria").value.trim();

        const errorNombre = document.getElementById("errorNombreConcesionaria");
        const errorCantidad = document.getElementById("errorCantidadTrabajadores");

        let valido = true;

        // Limpiar mensajes previos
        errorNombre.textContent = "";
        errorCantidad.textContent = "";

        // Validación: Nombre solo letras (sin números ni caracteres especiales)
        if (!/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/.test(nombre)) {
            errorNombre.textContent = "⚠️ El nombre no puede contener números ni caracteres especiales.";
            valido = false;
        }

        // Validación: Cantidad solo números
        if (!/^[0-9]+$/.test(cantidad)) {
            errorCantidad.textContent = "⚠️ La cantidad de trabajadores solo puede contener números.";
            valido = false;
        }

        return valido;
    }

    // --- VALIDACIÓN EN VIVO ---
    document.getElementById("txtnombre_concesionaria").addEventListener("input", function () {
        const errorNombre = document.getElementById("errorNombreConcesionaria");
        if (/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]*$/.test(this.value.trim())) {
            errorNombre.textContent = "";
        } else {
            errorNombre.textContent = "⚠️ El nombre no puede contener números ni caracteres especiales.";
        }
    });

    document.getElementById("txtcantidad_trabaja_concesionaria").addEventListener("input", function () {
        const errorCantidad = document.getElementById("errorCantidadTrabajadores");
        if (/^[0-9]*$/.test(this.value.trim())) {
            errorCantidad.textContent = "";
        } else {
            errorCantidad.textContent = "⚠️ La cantidad de trabajadores solo puede contener números.";
        }
    });
</script>


</body>
</html>

